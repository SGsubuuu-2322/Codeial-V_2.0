<link rel="stylesheet" href="/css/home.css" />
<h1>Codeial | <%= title %> Page</h1>

<section class="feed-posts">
  <% if(locals.user){ %>
  <form action="/posts/create" method="post" class="new-post-form">
    <textarea
      name="content"
      cols="30"
      rows="3"
      placeholder="Write your post..."
      required
    ></textarea>
    <button type="submit">Add Post</button>
  </form>
  <% } %>

  <div class="post-lists-container">
    <ul class="post-lists">
      <% for(post of posts){ %>
      <p>
        <li><%= post.content %></li>
        <br />
        <small><%= post.user.name %></small>
      </p>

      <div class="post-comments">
        <%if(locals.user){%>
        <form action="/comments/create" method="post" class="new-comment-form">
          <input
            type="text"
            name="content"
            placeholder="Type here to add comment..."
            required
          />
          <input type="hidden" name="post" value="<%= post._id %>" />
          <button type="submit">Add Comment</button>
        </form>
        <%}%>

        <div class="post-comments-list">
          <ul id="post-comment-<%= post._id %>">
            <% for(comment of post.comments){ %>
            <p class="comment"><%= comment.content %></p>
            <small><%= comment.user.name %></small>
            <%}%>
          </ul>
        </div>
      </div>
      <%}%>
    </ul>
  </div>
</section>
